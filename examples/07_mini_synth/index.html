<!doctype html>
<html>
    <head>
        <meta charset="utf8">
        <title>Mini synth</title>
        <link href="../../dist/AudioTags.bundle.css" rel="stylesheet" media="all" />
    </head>
	<body>

		<p>A chain with a mini synth (another custom component built with audio tags), an oscilloscope and a vumeter should be created and displayed.</p>

		<audio-context>
			<audio-chain>
				<mini-synth></mini-synth>
				<audio-oscilloscope></audio-oscilloscope>
				<audio-vumeter></audio-vumeter>
			</audio-chain>
		</audio-context>

		<audio-keyboard octaves="2"></audio-keyboard>

		<script src="../../dist/AudioTags.bundle.js" type="text/javascript"></script>
		
		<script>
			require('AudioTags').register();
		</script>
		
		<script src="../js/mini-synth.js"></script>

		<script>

            window.addEventListener('DOMComponentsLoaded', function() {

				var minisynth = document.querySelector('mini-synth');

				document.querySelector('audio-chain').output.gain.value = 0.05;

				var keyboard = document.querySelector('audio-keyboard');

				keyboard.addEventListener('noteon', function(e) {

					var noteIndex = e.detail.index;
					minisynth.noteOn(parseInt(noteIndex, 10) + 40);
					minisynth.start();
					
				}, false);

				keyboard.addEventListener('noteoff', function(e) {

					minisynth.noteOff();
					
				}, false);

			}, false);

		</script>

    </body>
</html>





